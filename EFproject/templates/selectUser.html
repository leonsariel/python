{% extends 'base.html' %}
{% load staticfiles %}

{% block title %}
    Select a Worker
{% endblock %}


{% block custom_css %}
    <link href="{% static 'css/jquery.treetable.css' %}" media="all" rel="stylesheet" type="text/css">
{% endblock %}

{% block custom_js %}
    <script type="text/javascript" src="{% static 'js/jquery.min.js' %} "></script>
    <script type="text/javascript" src="{% static 'js/treeTable.js' %} "></script>
{% endblock %}



{% block content %}
    <div class="row">
        <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="x_panel">
                <form action="{% url 'selectUser' %}" method="post">
                    {% csrf_token %}
                    <table id="table" id="tree_table" class="table table-striped table-bordered dt-responsive nowrap"
                           cellspacing="0" width="100%">
                        <thead>
                        <tr>
                            <th>Name</th>
                            <th>Case Worker ID</th>
                            <th>Post Code</th>
                            <th>Role</th>
{#                            <th>Staff Count</th>#}

                        </tr>
                        </thead>

                        {% if director %}
                            {% for user in user3 %}
                                <tr data-tt-id="{{ user.id }}">
                                    <td>{{ user.firstName }} {{ user.lastName }}</td>
                                    <td>{{ user.id }}</td>
                                    <td>{{ user.postCode }}</td>
                                    <td>{{ user.role }}</td>
                                    <td>{{ user.is_staff }}</td>
                                </tr>

                                {% for key, values in dic.items %}
                                    {% for v in values %}
                                        {% for k,p in v.items %}
                                            {% if key.id == user.id %}
                                                <tr data-tt-id="{{ k.id }}" data-tt-parent-id="{{ key.id }}">
                                                    <td>&nbsp&nbsp&nbsp&nbsp{{ k.firstName }} {{ k.lastName }}</td>
                                                    <td>{{ k.id }}</td>
                                                    <td>{{ k.postCode }}</td>
                                                    <td>{{ k.role }}</td>
                                                    <td></td>
                                                </tr>
                                                {% for q in p %}
                                                    <tr data-tt-id="{{ q.id }}" data-tt-parent-id="{{ k.id }}">
                                                        <td>
                                                            <button type="submit" name="uid" class="linkbutton"
                                                                    value="{{ q.id }}">
                                                                &nbsp&nbsp&nbsp&nbsp{{ q.firstName }} {{ q.lastName }}</button>
                                                        </td>
                                                        <td>{{ q.id }}</td>
                                                        <td>{{ q.postCode }}</td>
                                                        <td>{{ q.role }}</td>
                                                        <td></td>
                                                    </tr>
                                                {% endfor %}
                                            {% endif %}


                                        {% endfor %}
                                    {% endfor %}

                                {% endfor %}

                            {% endfor %}
                        {% endif %}



                        {% if manager %}
                            {% for user in user2 %}
                                <tr data-tt-id="{{ user.id }}">
                                    <td>{{ user.firstName }} {{ user.lastName }}</td>
                                    <td>{{ user.id }}</td>
                                    <td>{{ user.postCode }}</td>
                                    <td>{{ user.role }}</td>
                                    {#                                    <td>{{ dic|key:user|length }}</td>#}
                                </tr>
                                {% for key, values in dic.items %}
                                    {% for v in values %}
                                        {% if key.id == user.id %}
                                            <tr data-tt-id="{{ v.id }}" data-tt-parent-id="{{ key.id }}">
                                            <td>
                                                <button type="submit" name="uid" class="linkbutton"
                                                        value="{{ v.id }}">{{ v.firstName }} {{ v.lastName }}</button>
                                            </td>
                                            <td>{{ v.id }}</td>
                                            <td>{{ v.postCode }}</td>
                                            <td>{{ v.role }}</td>
                                            {#                                            <td></td>#}
                                        {% endif %}
                                    </tr>
                                    {% endfor %}

                                {% endfor %}
                            {% endfor %}
                        {% endif %}

                        {% if supervisor %}
                            {% for user in user1 %}
                                <tr data-tt-id="{{ user.id }}">
                                    <td>
                                        <button type="submit" name="uid" class="linkbutton"
                                                value="{{ user.id }}">{{ user.firstName }} {{ user.lastName }}</button>
                                    </td>
                                    <td>{{ user.id }}</td>
                                    <td>{{ user.postCode }}</td>
                                    <td>{{ user.role }}</td>
                                    {#                                  <td>{{ dic|key:user|length }}</td>#}
                                </tr>

                            {% endfor %}
                        {% endif %}


                    </table>

                </form>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        com_github_culmat_jsTreeTable.register(this)

        treeTable($('#table'))
    </script>

{% endblock %}